# F1 Miniatures Collection Manager - Etapa 1

Sistema para gerenciar cole√ß√£o de miniaturas de carros de F√≥rmula 1.

## Funcionalidades da Etapa 1:
- ‚úÖ Cadastro de miniaturas (modelo, descri√ß√£o, piloto)
- ‚úÖ Cadastro de equipes de F1
- ‚úÖ Suporte a equipes personalizadas
- ‚úÖ Interface web responsiva
- ‚úÖ Banco de dados PostgreSQL

## Pr√©-requisitos:
- Python 3.8 ou superior
- PostgreSQL 12 ou superior

---

## Instala√ß√£o por Sistema Operacional

### üêß Linux (Ubuntu/Debian)

```bash
# 1. Atualizar sistema
sudo apt update && sudo apt upgrade -y

# 2. Instalar Python e PostgreSQL
sudo apt install python3 python3-pip python3-venv postgresql postgresql-contrib -y

# 3. Configurar PostgreSQL
sudo systemctl start postgresql
sudo systemctl enable postgresql

# 4. Criar usu√°rio e banco de dados
sudo -u postgres psql
CREATE USER f1user WITH PASSWORD 'f1password';
CREATE DATABASE f1miniatures OWNER f1user;
GRANT ALL PRIVILEGES ON DATABASE f1miniatures TO f1user;
\q

# 5. Clonar/baixar o projeto e entrar no diret√≥rio
cd f1_miniatures

# 6. Criar ambiente virtual
python3 -m venv venv
source venv/bin/activate

# 7. Instalar depend√™ncias
pip install -r requirements.txt

# 8. Inicializar banco de dados
python init_db.py

# 9. Executar aplica√ß√£o
python app.py
```

### üçé macOS

```bash
# 1. Instalar Homebrew (se n√£o tiver)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 2. Instalar Python e PostgreSQL
brew install python postgresql

# 3. Iniciar PostgreSQL
brew services start postgresql

# 4. Criar usu√°rio e banco de dados
psql postgres
CREATE USER f1user WITH PASSWORD 'f1password';
CREATE DATABASE f1miniatures OWNER f1user;
GRANT ALL PRIVILEGES ON DATABASE f1miniatures TO f1user;
\q

# 5. Clonar/baixar o projeto e entrar no diret√≥rio
cd f1_miniatures

# 6. Criar ambiente virtual
python3 -m venv venv
source venv/bin/activate

# 7. Instalar depend√™ncias
pip install -r requirements.txt

# 8. Inicializar banco de dados
python init_db.py

# 9. Executar aplica√ß√£o
python app.py
```

### ü™ü Windows

```cmd
# 1. Baixar e instalar Python 3.8+ de https://python.org
# 2. Baixar e instalar PostgreSQL de https://postgresql.org

# 3. Abrir Command Prompt como Administrador

# 4. Configurar PostgreSQL (substituir CAMINHO_POSTGRESQL pelo caminho real)
cd "C:\Program Files\PostgreSQL\15\bin"
psql -U postgres
CREATE USER f1user WITH PASSWORD 'f1password';
CREATE DATABASE f1miniatures OWNER f1user;
GRANT ALL PRIVILEGES ON DATABASE f1miniatures TO f1user;
\q

# 5. Navegar at√© o diret√≥rio do projeto
cd C:\caminho\para\f1_miniatures

# 6. Criar ambiente virtual
python -m venv venv
venv\Scripts\activate

# 7. Instalar depend√™ncias
pip install -r requirements.txt

# 8. Inicializar banco de dados
python init_db.py

# 9. Executar aplica√ß√£o
python app.py
```

---

## üê≥ Configura√ß√£o com Docker (Recomendada - Todos os SOs)

### **Vantagens do Docker:**
- ‚úÖ N√£o precisa instalar PostgreSQL manualmente
- ‚úÖ Funciona igual em Windows, Linux e macOS
- ‚úÖ Ambiente isolado e reproduz√≠vel
- ‚úÖ Configura√ß√£o autom√°tica do banco de dados

### **Pr√©-requisitos Docker:**
- Docker Desktop (Windows/Mac) ou Docker Engine (Linux)
- Docker Compose

---

### **Instala√ß√£o do Docker por Sistema:**

#### ü™ü **Windows:**
1. Baixar **Docker Desktop** de https://docker.com/products/docker-desktop
2. Instalar e reiniciar o computador
3. Abrir Docker Desktop e aguardar inicializa√ß√£o

#### üêß **Linux (Ubuntu/Debian):**
```bash
# Instalar Docker
sudo apt update
sudo apt install docker.io docker-compose -y
sudo systemctl start docker
sudo systemctl enable docker

# Adicionar usu√°rio ao grupo docker (opcional)
sudo usermod -aG docker $USER
# Logout e login novamente
```

#### üçé **macOS:**
1. Baixar **Docker Desktop** de https://docker.com/products/docker-desktop
2. Instalar arrastando para Applications
3. Abrir Docker Desktop

---

### **üìã Passos Detalhados para Rodar com Docker:**

#### **1. Preparar Arquivos**
```bash
# Criar diret√≥rio do projeto
mkdir f1_miniatures
cd f1_miniatures

# Criar estrutura de diret√≥rios
mkdir templates static
```

#### **2. Criar docker-compose.yml**
Crie o arquivo `docker-compose.yml` na raiz do projeto:

```yaml
version: '3.8'

services:
  # Banco de dados PostgreSQL
  db:
    image: postgres:15-alpine
    container_name: f1_postgres
    environment:
      POSTGRES_DB: f1miniatures
      POSTGRES_USER: f1user
      POSTGRES_PASSWORD: f1password
      POSTGRES_INITDB_ARGS: "--encoding=UTF-8 --lc-collate=C --lc-ctype=C"
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U f1user -d f1miniatures"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - f1_network

  # Aplica√ß√£o Flask
  app:
    build: .
    container_name: f1_app
    ports:
      - "5000:5000"
    depends_on:
      db:
        condition: service_healthy
    environment:
      DATABASE_URL: postgresql://f1user:f1password@db:5432/f1miniatures
      FLASK_ENV: development
      FLASK_DEBUG: "True"
    volumes:
      - .:/app  # Para desenvolvimento (hot reload)
    networks:
      - f1_network
    restart: unless-stopped

volumes:
  postgres_data:
    driver: local

networks:
  f1_network:
    driver: bridge
```

#### **3. Adicionar todos os arquivos do projeto**
Certifique-se de que todos os arquivos est√£o na estrutura correta:
```
f1_miniatures/
‚îú‚îÄ‚îÄ docker-compose.yml    ‚Üê Arquivo Docker
‚îú‚îÄ‚îÄ Dockerfile           ‚Üê Arquivo Docker
‚îú‚îÄ‚îÄ app.py
‚îú‚îÄ‚îÄ models.py
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ init_db.py
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ style.css
‚îÇ   ‚îî‚îÄ‚îÄ script.js
‚îî‚îÄ‚îÄ templates/
    ‚îú‚îÄ‚îÄ base.html
    ‚îú‚îÄ‚îÄ index.html
    ‚îú‚îÄ‚îÄ add_miniature.html
    ‚îî‚îÄ‚îÄ add_team.html
```

#### **4. Executar a Aplica√ß√£o**

##### **üöÄ Primeira execu√ß√£o (build e run):**
```bash
# Navegar at√© o diret√≥rio do projeto
cd f1_miniatures

# Construir e executar todos os servi√ßos
docker-compose up --build

# Ou em modo detached (em background)
docker-compose up --build -d
```

##### **‚ö° Execu√ß√µes posteriores:**
```bash
# Apenas executar (sem rebuild)
docker-compose up

# Ou em background
docker-compose up -d
```

#### **5. Acessar a Aplica√ß√£o**
- **URL**: http://localhost:5000
- **Banco**: localhost:5432 (se precisar conectar diretamente)

---

### **üõ†Ô∏è Comandos √öteis do Docker:**

#### **Gerenciamento de Containers:**
```bash
# Ver containers rodando
docker-compose ps

# Ver logs da aplica√ß√£o
docker-compose logs app

# Ver logs do banco
docker-compose logs db

# Ver logs em tempo real
docker-compose logs -f

# Parar todos os servi√ßos
docker-compose down

# Parar e remover volumes (CUIDADO: apaga dados!)
docker-compose down -v
```

#### **Desenvolvimento e Debug:**
```bash
# Reconstruir apenas a aplica√ß√£o
docker-compose build app

# Executar comandos dentro do container
docker-compose exec app bash

# Executar comandos no banco
docker-compose exec db psql -U f1user -d f1miniatures

# Reiniciar apenas a aplica√ß√£o
docker-compose restart app
```

#### **Backup e Manuten√ß√£o:**
```bash
# Backup do banco de dados
docker-compose exec db pg_dump -U f1user f1miniatures > backup.sql

# Restaurar backup
docker-compose exec -T db psql -U f1user f1miniatures < backup.sql

# Ver uso de espa√ßo
docker system df

# Limpar containers n√£o utilizados
docker system prune
```

---

### **üîß Resolu√ß√£o de Problemas Docker:**

#### **Problema: "Port already in use" (Porta j√° est√° em uso)**

**Solu√ß√£o Autom√°tica (Recomendada):**
```bash
# O script start.sh agora detecta automaticamente e oferece op√ß√µes
./start.sh  # Ele vai perguntar como resolver
```

**Solu√ß√£o Manual:**
```bash
# 1. Usar script espec√≠fico para resolver conflitos
chmod +x fix-port.sh
./fix-port.sh

# 2. Verificar o que est√° usando a porta
sudo lsof -i :5000

# 3. Matar processo espec√≠fico
sudo kill -9 PID_DO_PROCESSO

# 4. Ou usar porta alternativa manualmente
# Editar docker-compose.yml:
# ports:
#   - "5001:5000"  # Em vez de "5000:5000"
```

**Causas Comuns:**
- ‚úã Outro container F1 Miniatures rodando
- ‚úã Flask/Django rodando localmente
- ‚úã Outro servi√ßo web na porta 5000
- ‚úã AirPlay no macOS (usa porta 5000)

**Desabilitar AirPlay no macOS:**
```bash
# Ir em: System Preferences > Sharing > AirPlay Receiver
# Ou temporariamente:
sudo lsof -ti :5000 | xargs sudo kill -9
```

#### **Problema: "Database connection failed"**
```bash
# Verificar se o PostgreSQL est√° rodando
docker-compose ps

# Ver logs do banco
docker-compose logs db

# Reiniciar banco
docker-compose restart db
```

#### **Problema: "Build failed"**
```bash
# Limpar cache do Docker
docker builder prune

# Reconstruir do zero
docker-compose build --no-cache
docker-compose up
```

#### **Problema: Altera√ß√µes no c√≥digo n√£o aparecem**
```bash
# Verificar se o volume est√° mapeado
docker-compose exec app ls -la /app

# Reiniciar aplica√ß√£o
docker-compose restart app

# Ou rebuild se mudou depend√™ncias
docker-compose build app
```

---

### **üéØ Vantagens da Vers√£o Docker:**

1. **Instala√ß√£o Simplificada**: Um comando para tudo
2. **Ambiente Consistente**: Funciona igual em qualquer m√°quina
3. **Isolamento**: N√£o interfere com outros projetos
4. **PostgreSQL Autom√°tico**: Banco configurado automaticamente
5. **Hot Reload**: Mudan√ßas no c√≥digo aparecem automaticamente
6. **F√°cil Reset**: `docker-compose down -v` limpa tudo

---

### **üìù Workflow de Desenvolvimento com Docker:**

1. **Primeira vez:**
   ```bash
   docker-compose up --build -d
   ```

2. **Desenvolvimento di√°rio:**
   ```bash
   # Iniciar
   docker-compose up -d
   
   # Parar ao final do dia
   docker-compose down
   ```

3. **Ver logs durante desenvolvimento:**
   ```bash
   docker-compose logs -f app
   ```

4. **Reset completo (se algo der errado):**
   ```bash
   docker-compose down -v
   docker-compose up --build
   ```

---

## Uso da Aplica√ß√£o

1. **Acesse**: http://localhost:5000
2. **Adicionar Equipe**: Clique em "Adicionar Equipe" para cadastrar novas equipes
3. **Adicionar Miniatura**: Clique em "Adicionar Miniatura" para cadastrar suas miniaturas
4. **Visualizar Cole√ß√£o**: A p√°gina inicial mostra todas as miniaturas cadastradas

## Estrutura de Dados

### Equipes (teams)
- Nome da equipe
- Pa√≠s
- Flag para equipes personalizadas

### Miniaturas (miniatures)
- Modelo
- Descri√ß√£o
- Piloto
- Equipe (relacionamento)
- Ano
- Escala
- Data de cadastro

## Pr√≥ximas Etapas

- **Etapa 2**: Editar e excluir registros
- **Etapa 3**: Upload e gerenciamento de fotos
- **Etapa 4**: Integra√ß√£o com v√≠deos do YouTube

## Estrutura do Projeto

```
f1_miniatures/
‚îú‚îÄ‚îÄ app.py                 # Aplica√ß√£o principal Flask
‚îú‚îÄ‚îÄ models.py             # Modelos do banco de dados
‚îú‚îÄ‚îÄ config.py             # Configura√ß√µes
‚îú‚îÄ‚îÄ requirements.txt      # Depend√™ncias Python
‚îú‚îÄ‚îÄ init_db.py           # Script para inicializar o banco
‚îú‚îÄ‚îÄ static/              # Arquivos est√°ticos (CSS, JS)
‚îÇ   ‚îú‚îÄ‚îÄ style.css
‚îÇ   ‚îî‚îÄ‚îÄ script.js
‚îú‚îÄ‚îÄ templates/           # Templates HTML
‚îÇ   ‚îú‚îÄ‚îÄ base.html
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ add_miniature.html
‚îÇ   ‚îî‚îÄ‚îÄ add_team.html
‚îî‚îÄ‚îÄ README.md           # Instru√ß√µes de instala√ß√£o
```

## Problemas Comuns

### Erro de Conex√£o com PostgreSQL:
1. Verifique se o PostgreSQL est√° rodando
2. Confirme usu√°rio e senha
3. Teste conex√£o: `psql -U f1user -d f1miniatures -h localhost`

### Erro "Module not found":
1. Ative o ambiente virtual: `source venv/bin/activate` (Linux/Mac) ou `venv\Scripts\activate` (Windows)
2. Reinstale depend√™ncias: `pip install -r requirements.txt`

### Porta 5000 ocupada:
1. Mate processo: `sudo lsof -ti:5000 | xargs kill -9`
2. Ou mude a porta no arquivo `app.py`

## Tecnologias Utilizadas

- **Backend**: Python 3.8+ + Flask 2.3.3
- **Database**: PostgreSQL 12+
- **Frontend**: HTML5 + Bootstrap 5 + JavaScript
- **ORM**: SQLAlchemy
- **Styling**: CSS customizado com tema F1

## Features Implementadas

### ‚úÖ Cadastro de Miniaturas
- Modelo obrigat√≥rio
- Descri√ß√£o opcional
- Piloto opcional
- Sele√ß√£o de equipe ou equipe personalizada
- Ano e escala opcionais

### ‚úÖ Gerenciamento de Equipes
- Cadastro de novas equipes
- Equipes F1 oficiais pr√©-carregadas
- Suporte a equipes personalizadas
- Relacionamento com miniaturas

### ‚úÖ Interface Responsiva
- Design moderno inspirado na F1
- Compat√≠vel com mobile, tablet e desktop
- Mensagens de feedback
- Valida√ß√£o de formul√°rios

### ‚úÖ Banco de Dados Robusto
- PostgreSQL (n√£o SQLite)
- Relacionamentos adequados
- Migra√ß√µes autom√°ticas
- Dados iniciais

---

**Desenvolvido para disciplina acad√™mica - Etapa 1/4**

## Licen√ßa

Este projeto √© desenvolvido para fins acad√™micos.